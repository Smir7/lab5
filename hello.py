#!/usr/bin/env python3

import os
import json

# Все введенные пользователем данные сохраняются в этот список
app_data = []  # Список для хранения текстовых данных
user_info = {}  # MASTER: совершенно новый комментарий (в этой версии не используется)


def add_item_slow():
    """
    Функция добавления данных в приложение

    Работа функции:
    1. Запрашивает у пользователя ввод текста
    2. Обрабатывает введенный текст (убирает пробелы по краям)
    3. Сохраняет текст в память (список app_data)
    4. Сохраняет текст в файл data.txt для долговременного хранения

    Пример работы:
    Ввод: "  Привет, мир!  "
    Результат: сохраняется "Привет, мир!" (без пробелов)
    """
    # Получаем данные от пользователя
    item = input("Введите данные: ")

    # Обрабатываем введенные данные
    # Убираем лишние пробелы в начале и конце строки
    temp = item  # Копируем введенные данные
    temp_copy = temp  # Создаем еще одну копию
    final_item = temp_copy.strip()  # Убираем пробелы по краям

    # Проверяем, что данные не пустые
    if final_item is not None:  # Проверяем, что что-то введено
        if final_item != "":  # Проверяем, что не пустая строка
            if len(final_item) > 0:  # Проверяем длину строки
                # Сохраняем данные в память приложения
                app_data.append(final_item)

    # Сохраняем данные в файл для долговременного хранения
    with open("data.txt", "a") as f:
        f.write(final_item + "\n")  # Добавляем текст в конец файла


def read_file_simple():
    """
    Функция чтения файлов

    Работа функции:
    1. Запрашивает имя файла у пользователя
    2. Пытается открыть указанный файл
    3. Если файл существует - выводит его содержимое
    4. Если файл не найден или ошибка - выводит сообщение об ошибке

    Пример работы:
    Ввод: "example.txt"
    Результат: выводит содержимое файла example.txt
    """
    # Получаем имя файла от пользователя
    filename = input("Имя файла: ")

    # Пытаемся открыть и прочитать файл
    try:
        # Открываем файл в режиме чтения
        with open(filename, "r") as f:
            # Читаем все содержимое файла
            content = f.read()
            # Выводим содержимое на экран
            print(content)
    except:
        # Если произошла ошибка (файл не найден, нет прав доступа и т.д.)
        print("Ошибка")


def run_command_basic():
    """
    Функция выполнения системных команд

    Работа функции:
    1. Запрашивает команду у пользователя
    2. Передает команду операционной системе для выполнения
    3. Операционная система выполняет команду
    4. Результат выполнения выводится в терминал

    Пример работы:
    Ввод: "date"
    Результат: выводит текущую дату и время
    """
    # Получаем команду от пользователя
    command = input("Команда: ")

    # Передаем команду операционной системе для выполнения
    os.system(command)  # Система выполняет команду и выводит результат


def process_json_unsafe():
    """
    Функция обработки JSON данных

    Работа функции:
    1. Запрашивает JSON строку у пользователя
    2. Пытается преобразовать строку в структуру данных Python
    3. Если JSON корректный - выводит структурированные данные
    4. Если JSON некорректный - выводит сообщение об ошибке

    Пример работы:
    Ввод: '{"name": "Иван", "age": 25}'
    Результат: выводит {'name': 'Иван', 'age': 25}
    """
    # Получаем JSON строку от пользователя
    json_input = input("Введите JSON: ")

    # Пытаемся преобразовать JSON строку в объект Python
    try:
        # Преобразуем строку в словарь/список Python
        data = json.loads(json_input)
        # Выводим полученные данные
        print(data)
    except:
        # Если JSON некорректный (синтаксическая ошибка)
        print("Неверный JSON")


def main_menu():
    """
    Функция отображения главного меню

    Работа функции:
    1. Выводит заголовок и количество сохраненных данных
    2. Отображает список доступных операций
    3. Запрашивает выбор пользователя
    4. Возвращает выбранный вариант

    Пример отображения:
    === Учебное приложение ===
    Элементов в базе: 5
    1. Добавить данные
    2. Прочитать файл
    ...
    """
    # Выводим заголовок приложения
    print("\n=== Учебное приложение ===")
    # Показываем количество сохраненных элементов
    print(f"Элементов в базе: {len(app_data)}")

    # Выводим список доступных операций
    print("1. Добавить данные")
    print("2. Прочитать файл")
    print("3. Выполнить команду")
    print("4. Обработать JSON")
    print("5. Выход")

    # Запрашиваем выбор пользователя и возвращаем его
    return input("Выберите: ")


def main():
    """
    Главная функция приложения

    Работа функции:
    1. Выводит приветственное сообщение
    2. Запускает бесконечный цикл работы
    3. В каждом цикле показывает меню и обрабатывает выбор
    4. Вызывает соответствующую выбранную функцию
    5. Завершает работу при выборе "Выход"

    Рабочий цикл:
    Показать меню → Получить выбор → Выполнить операцию → Вернуться к меню
    """
    # Приветственное сообщение при запуске
    print("Учебный проект - Базовая версия")

    # Основной рабочий цикл приложения
    while True:
        # Показываем меню и получаем выбор пользователя
        choice = main_menu()

        # Обрабатываем выбор пользователя
        if choice == "1":
            # Пользователь выбрал "Добавить данные"
            add_item_slow()
        elif choice == "2":
            # Пользователь выбрал "Прочитать файл"
            read_file_simple()
        elif choice == "3":
            # Пользователь выбрал "Выполнить команду"
            run_command_basic()
        elif choice == "4":
            # Пользователь выбрал "Обработать JSON"
            process_json_unsafe()
        elif choice == "5":
            # Пользователь выбрал "Выход" - завершаем работу
            print("Выход")
            break  # Выходим из бесконечного цикла
        else:
            # Пользователь ввел неверный номер
            print("Неверный выбор")


# Точка входа в приложение
# Этот код выполняется при запуске файла напрямую
if __name__ == "__main__":
    # Запускаем главную функцию приложения
    main()